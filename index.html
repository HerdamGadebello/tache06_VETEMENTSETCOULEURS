<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu de Machine à Sous Français</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Franklin+Gothic+Demi&display=swap" rel="stylesheet">
    <style>
        /* Reset e estilos base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --azul-marinho: #002F6C;
            --vermelho: #C8102E;
            --bege-claro: #F4F1EC;
            --verde: #3B8C59;
            --amarelo: #F5C84C;
            --lavanda: #C6B9DD;
            --ciano: #007BA7;
            --vinho: #6C002F;
            --verde-floresta: #2E6C00;
            --marrom-dourado: #6C4500;
            --magenta: #A7007B;
            --turquesa: #10C894;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            background-color: var(--bege-claro);
        }
        
        /* Página de introdução */
        #intro-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('fundo.jpg') no-repeat center center;
            background-size: cover;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            transition: opacity 1s ease;
        }
        
        #intro-video {
            width: 60%;
            max-width: 800px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        /* Página inicial do quiz */
        #home-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #F1E1AC;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 90;
        }
        
        .mascot {
            width: 200px;
            margin-bottom: 30px;
        }
        
        .start-button {
            background-color: var(--azul-marinho);
            color: white;
            font-family: 'Franklin Gothic Demi', sans-serif;
            font-size: 1.5rem;
            padding: 15px 40px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .start-button:hover {
            transform: scale(1.05);
        }
        
        /* Página do jogo */
        #game-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #F1E1AC;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 80;
            padding: 20px;
        }
        
        .logo {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 80px;
            height: auto;
        }
        
        .game-container {
            background-color: var(--azul-marinho);
            border-radius: 20px;
            padding: 20px;
            width: 90%;
            max-width: 600px;
            position: relative;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .mascot-small {
            position: absolute;
            bottom: -30px;
            left: -30px;
            width: 80px;
            height: auto;
        }
        
        .enunciado {
            background-color: var(--vermelho);
            border-radius: 50px;
            padding: 12px 20px;
            text-align: center;
            margin: -40px auto 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            z-index: 10;
        }
        
        .enunciado p {
            font-family: 'Rockwell', serif;
            color: white;
            font-size: 1rem;
        }
        
        .slots-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            gap: 15px;
        }
        
        .slot {
            width: 45%;
            height: 150px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
            border: 3px solid var(--amarelo);
        }
        
        .slot-inner {
            position: absolute;
            width: 100%;
            transition: top 4s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        }
        
        .slot-item {
            height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .slot-item img {
            max-width: 85%;
            max-height: 85%;
            object-fit: contain;
        }
        
        .spin-button {
            background-color: var(--verde);
            color: white;
            font-family: 'Franklin Gothic Demi', sans-serif;
            font-size: 1rem;
            padding: 10px 25px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            display: block;
            margin: 0 auto 15px;
            transition: transform 0.2s;
        }
        
        .spin-button:hover {
            transform: scale(1.05);
        }
        
        .options-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin: 15px 0;
        }
        
        .option {
            background-color: var(--lavanda);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        
        .option:hover {
            background-color: #B0A0CC;
            transform: translateY(-3px);
        }
        
        .option.selected {
            background-color: var(--amarelo);
        }
        
        .sentence-container {
            min-height: 50px;
            background: white;
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            justify-content: center;
        }
        
        .word-slot {
            background-color: var(--bege-claro);
            padding: 6px 12px;
            border-radius: 5px;
            min-width: 70px;
            min-height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
        }
        
        .check-button {
            background-color: var(--verde);
            color: white;
            font-family: 'Franklin Gothic Demi', sans-serif;
            font-size: 1rem;
            padding: 10px 25px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            display: block;
            margin: 15px auto;
            transition: transform 0.2s;
        }
        
        .check-button:hover {
            transform: scale(1.05);
        }
        
        .feedback {
            text-align: center;
            font-family: 'Cooper Black', serif;
            font-size: 1.3rem;
            margin: 8px 0;
            min-height: 35px;
        }
        
        .correct {
            color: var(--verde);
        }
        
        .incorrect {
            color: var(--vermelho);
        }
        
        .correct-answer {
            text-align: center;
            font-size: 1rem;
            margin: 8px 0;
            color: var(--azul-marinho);
        }
        
        .translation {
            text-align: center;
            font-size: 0.9rem;
            margin: 5px 0;
            color: var(--vinho);
            font-style: italic;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .nav-button {
            padding: 8px 20px;
            border-radius: 50px;
            border: none;
            font-family: 'Franklin Gothic Demi', sans-serif;
            font-size: 0.9rem;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .nav-button:hover {
            transform: scale(1.05);
        }
        
        .prev-button {
            background-color: var(--amarelo);
        }
        
        .next-button {
            background-color: var(--verde);
            color: white;
        }
        
        .progress-container {
            width: 90%;
            max-width: 600px;
            height: 8px;
            background-color: var(--bege-claro);
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--turquesa);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        /* Página de resultados */
        #results-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #F1E1AC;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 70;
            padding: 20px;
        }
        
        .results-container {
            background-color: var(--azul-marinho);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            text-align: center;
            color: white;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .results-title {
            background-color: var(--vermelho);
            border-radius: 50px;
            padding: 12px;
            font-family: 'Franklin Gothic Demi', sans-serif;
            font-size: 1.8rem;
            margin-bottom: 15px;
        }
        
        .results-text {
            font-family: 'Poppins', sans-serif;
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 0.95rem;
        }
        
        .results-mascot {
            width: 150px;
            margin: 0 auto;
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            #intro-video {
                width: 90%;
            }
            
            .slots-container {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .slot {
                width: 90%;
                height: 130px;
            }
            
            .slot-item {
                height: 130px;
            }
            
            .enunciado p {
                font-size: 0.9rem;
            }
            
            .option {
                font-size: 0.8rem;
                padding: 6px 10px;
            }
            
            .game-container {
                padding: 15px;
            }
            
            .mascot-small {
                width: 60px;
                bottom: -20px;
                left: -20px;
            }
            
            .logo {
                width: 60px;
                top: 15px;
                left: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .slot {
                height: 110px;
                width: 95%;
            }
            
            .slot-item {
                height: 110px;
            }
            
            .results-container {
                padding: 20px;
            }
            
            .results-title {
                font-size: 1.5rem;
            }
            
            .start-button {
                font-size: 1.2rem;
                padding: 12px 30px;
            }
            
            .mascot {
                width: 150px;
            }
            
            .word-slot {
                min-width: 60px;
                font-size: 0.9rem;
            }
        }
        
        /* Animações */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .slide-in {
            animation: slideIn 0.4s ease-out;
        }
        
        /* Estilo para elementos desabilitados */
        .disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- Página de Introdução -->
    <div id="intro-page">
        <video id="intro-video" autoplay muted>
            <source src="VIDEOINTRO.mp4" type="video/mp4">
            Seu navegador não suporta o elemento de vídeo.
        </video>
        <audio id="intro-audio" src="SOMINTRO.mp3" autoplay></audio>
    </div>

    <!-- Página Inicial do Quiz -->
    <div id="home-page">
        <img src="MASCOTENEUTRO.png" alt="Mascote" class="mascot">
        <button class="start-button" id="start-button">INICIAR EXERCÍCIO</button>
    </div>

    <!-- Página do Jogo -->
    <div id="game-page">
        <img src="LOGODAMIAO.png" alt="Logo" class="logo">
        <div class="game-container">
            <img src="MASCOTENINHO.png" alt="Mascote pequeno" class="mascot-small">
            <div class="enunciado">
                <p>Forme uma frase indefinida usando as seguintes imagens:</p>
            </div>
            
            <div class="slots-container">
                <div class="slot" id="clothes-slot">
                    <div class="slot-inner" id="clothes-slot-inner">
                        <!-- Itens serão preenchidos via JavaScript -->
                    </div>
                </div>
                <div class="slot" id="colors-slot">
                    <div class="slot-inner" id="colors-slot-inner">
                        <!-- Itens serão preenchidos via JavaScript -->
                    </div>
                </div>
            </div>
            
            <button class="spin-button" id="spin-button">Girar Roleta</button>
            
            <div class="options-container" id="options-container">
                <!-- Opções serão preenchidas via JavaScript -->
            </div>
            
            <div class="sentence-container" id="sentence-container">
                <div class="word-slot" id="article-slot"></div>
                <div class="word-slot" id="clothes-slot-word"></div>
                <div class="word-slot" id="colors-slot-word"></div>
            </div>
            
            <button class="check-button" id="check-button">Verificar</button>
            
            <div class="feedback" id="feedback"></div>
            <div class="correct-answer" id="correct-answer"></div>
            <div class="translation" id="translation"></div>
            
            <div class="navigation">
                <button class="nav-button prev-button" id="prev-button">VOLTAR</button>
                <button class="nav-button next-button" id="next-button">AVANÇAR</button>
            </div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>

    <!-- Página de Resultados -->
    <div id="results-page">
        <div class="results-container">
            <div class="results-title" id="results-title"></div>
            <div class="results-text" id="results-text"></div>
            <img src="" alt="Mascote resultado" class="results-mascot" id="results-mascot">
            <audio id="results-audio"></audio>
        </div>
    </div>

    <!-- Elementos de áudio -->
    <audio id="button-sound" src="BUTTON.mp3"></audio>
    <audio id="win-sound" src="WIN.wav"></audio>
    <audio id="error-sound" src="ERROR.wav"></audio>
    <audio id="positive-sound" src="POSITIVO.mp3"></audio>
    <audio id="negative-sound" src="NEGATIVO.mp3"></audio>

    <script>
        // Dados do jogo
        const clothes = [
            { name: "écharpe", article: "une", image: "L'écharpe.png", gender: "f", number: "s" },
            { name: "bangue", article: "une", image: "la bangue.png", gender: "f", number: "s" },
            { name: "botte", article: "une", image: "la botte.png", gender: "f", number: "s" },
            { name: "casquette", article: "une", image: "la casquette.png", gender: "f", number: "s" },
            { name: "ceinture", article: "une", image: "la ceinture.png", gender: "f", number: "s" },
            { name: "chaussure", article: "une", image: "la chaussure.png", gender: "f", number: "s" },
            { name: "cravate", article: "une", image: "la cravate.png", gender: "f", number: "s" },
            { name: "jupe", article: "une", image: "la jupe.png", gender: "f", number: "s" },
            { name: "montre", article: "une", image: "la montre.png", gender: "f", number: "s" },
            { name: "robe", article: "une", image: "la robe.png", gender: "f", number: "s" },
            { name: "sandale", article: "une", image: "la sandale.png", gender: "f", number: "s" },
            { name: "blouson", article: "un", image: "le blouson.png", gender: "m", number: "s" },
            { name: "bracelet", article: "un", image: "le bracelet.png", gender: "m", number: "s" },
            { name: "chapeau", article: "un", image: "le chapeau.png", gender: "m", number: "s" },
            { name: "collier", article: "un", image: "le collier.png", gender: "m", number: "s" },
            { name: "haut", article: "un", image: "le haut.png", gender: "m", number: "s" },
            { name: "manteau", article: "un", image: "le manteau.png", gender: "m", number: "s" },
            { name: "pantalon", article: "un", image: "le pantalon.png", gender: "m", number: "s" },
            { name: "parapluie", article: "un", image: "le parapluie.png", gender: "m", number: "s" },
            { name: "sac", article: "un", image: "le sac.png", gender: "m", number: "s" },
            { name: "short", article: "un", image: "le short.png", gender: "m", number: "s" },
            { name: "t-shirt", article: "un", image: "le t-shirt.png", gender: "m", number: "s" },
            { name: "tong", article: "un", image: "le tong.png", gender: "m", number: "s" },
            { name: "boucles d'oreille", article: "des", image: "les boucles d'oreille.png", gender: "f", number: "p" },
            { name: "chaussettes", article: "des", image: "les chaussettes.png", gender: "f", number: "p" },
            { name: "gants", article: "des", image: "les gants.png", gender: "m", number: "p" },
            { name: "lunettes", article: "des", image: "les lunettes.png", gender: "f", number: "p" }
        ];

        const colors = [
            { name: "beige", variations: ["beige", "beiges"] },
            { name: "blanc", variations: ["blanc", "blanche", "blancs", "blanches"] },
            { name: "bleu clair", variations: ["bleu clair", "bleue claire", "bleus clairs", "bleues claires"] },
            { name: "bleu marine", variations: ["bleu marine", "bleue marine", "bleus marines", "bleues marines"] },
            { name: "bleu", variations: ["bleu", "bleue", "bleus", "bleues"] },
            { name: "gris", variations: ["gris", "grise", "gris", "grises"] },
            { name: "jaune", variations: ["jaune", "jaune", "jaunes", "jaunes"] },
            { name: "marron", variations: ["marron", "marrons"] },
            { name: "noir", variations: ["noir", "noire", "noirs", "noires"] },
            { name: "orange", variations: ["orange", "oranges"] },
            { name: "rose", variations: ["rose", "rose", "roses", "roses"] },
            { name: "rouge", variations: ["rouge", "rouge", "rouges", "rouges"] },
            { name: "vert", variations: ["vert", "verte", "verts", "vertes"] },
            { name: "violet", variations: ["violet", "violette", "violets", "violettes"] }
        ];

        // Traduções para português
        const translations = {
            "écharpe": "cachecol",
            "bangue": "pulseira",
            "botte": "bota",
            "casquette": "boné",
            "ceinture": "cinto",
            "chaussure": "sapato",
            "cravate": "gravata",
            "jupe": "saia",
            "montre": "relógio",
            "robe": "vestido",
            "sandale": "sandália",
            "blouson": "jaqueta",
            "bracelet": "pulseira",
            "chapeau": "chapéu",
            "collier": "colar",
            "haut": "blusa",
            "manteau": "casaco",
            "pantalon": "calça",
            "parapluie": "guarda-chuva",
            "sac": "bolsa",
            "short": "short",
            "t-shirt": "camiseta",
            "tong": "chinelo",
            "boucles d'oreille": "brincos",
            "chaussettes": "meias",
            "gants": "luvas",
            "lunettes": "óculos",
            "beige": "bege",
            "blanc": "branco",
            "bleu clair": "azul claro",
            "bleu marine": "azul marinho",
            "bleu": "azul",
            "gris": "cinza",
            "jaune": "amarelo",
            "marron": "marrom",
            "noir": "preto",
            "orange": "laranja",
            "rose": "rosa",
            "rouge": "vermelho",
            "vert": "verde",
            "violet": "violeta"
        };

        // Variáveis do jogo
        let currentClothesIndex = 0;
        let currentColorsIndex = 0;
        let selectedArticle = "";
        let selectedClothes = "";
        let selectedColor = "";
        let currentQuestion = 0;
        let totalQuestions = 20;
        let correctAnswers = 0;
        let isSpinning = false;
        let usedClothesIndices = [];

        // Elementos DOM
        const introPage = document.getElementById('intro-page');
        const introVideo = document.getElementById('intro-video');
        const homePage = document.getElementById('home-page');
        const gamePage = document.getElementById('game-page');
        const resultsPage = document.getElementById('results-page');
        const startButton = document.getElementById('start-button');
        const spinButton = document.getElementById('spin-button');
        const checkButton = document.getElementById('check-button');
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        const clothesSlotInner = document.getElementById('clothes-slot-inner');
        const colorsSlotInner = document.getElementById('colors-slot-inner');
        const optionsContainer = document.getElementById('options-container');
        const articleSlot = document.getElementById('article-slot');
        const clothesSlotWord = document.getElementById('clothes-slot-word');
        const colorsSlotWord = document.getElementById('colors-slot-word');
        const feedback = document.getElementById('feedback');
        const correctAnswer = document.getElementById('correct-answer');
        const translation = document.getElementById('translation');
        const progressBar = document.getElementById('progress-bar');
        const resultsTitle = document.getElementById('results-title');
        const resultsText = document.getElementById('results-text');
        const resultsMascot = document.getElementById('results-mascot');
        const resultsAudio = document.getElementById('results-audio');
        const buttonSound = document.getElementById('button-sound');
        const winSound = document.getElementById('win-sound');
        const errorSound = document.getElementById('error-sound');
        const positiveSound = document.getElementById('positive-sound');
        const negativeSound = document.getElementById('negative-sound');

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Preencher os slots com imagens
            fillSlots();
            
            // Configurar evento para o vídeo de introdução
            introVideo.addEventListener('ended', function() {
                introPage.style.opacity = '0';
                setTimeout(function() {
                    introPage.style.display = 'none';
                    homePage.style.display = 'flex';
                }, 1000);
            });
            
            // Configurar botões
            startButton.addEventListener('click', function() {
                playSound(buttonSound);
                homePage.style.display = 'none';
                gamePage.style.display = 'flex';
                generateQuestion();
            });
            
            spinButton.addEventListener('click', function() {
                if (!isSpinning) {
                    playSound(buttonSound);
                    spinSlots();
                }
            });
            
            checkButton.addEventListener('click', function() {
                playSound(buttonSound);
                checkAnswer();
            });
            
            prevButton.addEventListener('click', function() {
                playSound(buttonSound);
                if (currentQuestion > 0) {
                    currentQuestion--;
                    updateProgressBar();
                    generateQuestion();
                }
            });
            
            nextButton.addEventListener('click', function() {
                playSound(buttonSound);
                if (currentQuestion < totalQuestions - 1) {
                    currentQuestion++;
                    updateProgressBar();
                    generateQuestion();
                } else {
                    showResults();
                }
            });
        });

        // Funções do jogo
        function fillSlots() {
            // Preencher slot de roupas
            clothes.forEach((item, index) => {
                const slotItem = document.createElement('div');
                slotItem.className = 'slot-item';
                slotItem.innerHTML = `<img src="${item.image}" alt="${item.name}">`;
                slotItem.dataset.index = index;
                clothesSlotInner.appendChild(slotItem);
            });
            
            // Preencher slot de cores
            colors.forEach((color, index) => {
                const slotItem = document.createElement('div');
                slotItem.className = 'slot-item';
                slotItem.innerHTML = `<img src="${color.name}.png" alt="${color.name}">`;
                slotItem.dataset.index = index;
                colorsSlotInner.appendChild(slotItem);
            });
        }

        function spinSlots() {
            isSpinning = true;
            spinButton.classList.add('disabled');
            
            // Gerar índices aleatórios (não repetir roupas já usadas)
            let randomClothesIndex;
            do {
                randomClothesIndex = Math.floor(Math.random() * clothes.length);
            } while (usedClothesIndices.includes(randomClothesIndex) && usedClothesIndices.length < clothes.length);
            
            // Se já usamos todas as roupas, resetar
            if (usedClothesIndices.length >= clothes.length) {
                usedClothesIndices = [];
            }
            
            usedClothesIndices.push(randomClothesIndex);
            const randomColorsIndex = Math.floor(Math.random() * colors.length);
            
            // Calcular posições para os slots
            const clothesPosition = -randomClothesIndex * 150;
            const colorsPosition = -randomColorsIndex * 150;
            
            // Aplicar animação aos slots
            clothesSlotInner.style.transition = 'top 4s cubic-bezier(0.17, 0.67, 0.83, 0.67)';
            colorsSlotInner.style.transition = 'top 4s cubic-bezier(0.17, 0.67, 0.83, 0.67)';
            
            clothesSlotInner.style.top = clothesPosition + 'px';
            colorsSlotInner.style.top = colorsPosition + 'px';
            
            // Atualizar variáveis após a rotação
            setTimeout(function() {
                currentClothesIndex = randomClothesIndex;
                currentColorsIndex = randomColorsIndex;
                isSpinning = false;
                spinButton.classList.remove('disabled');
                generateOptions();
            }, 4000);
        }

        function generateQuestion() {
            // Limpar seleções anteriores
            selectedArticle = "";
            selectedClothes = "";
            selectedColor = "";
            
            articleSlot.textContent = "";
            clothesSlotWord.textContent = "";
            colorsSlotWord.textContent = "";
            feedback.textContent = "";
            correctAnswer.textContent = "";
            translation.textContent = "";
            
            optionsContainer.innerHTML = "";
            
            // Gerar slots aleatórios se não estiverem girando
            if (!isSpinning) {
                // Não repetir roupas já usadas
                let randomClothesIndex;
                do {
                    randomClothesIndex = Math.floor(Math.random() * clothes.length);
                } while (usedClothesIndices.includes(randomClothesIndex) && usedClothesIndices.length < clothes.length);
                
                // Se já usamos todas as roupas, resetar
                if (usedClothesIndices.length >= clothes.length) {
                    usedClothesIndices = [];
                }
                
                usedClothesIndices.push(randomClothesIndex);
                const randomColorsIndex = Math.floor(Math.random() * colors.length);
                
                clothesSlotInner.style.transition = 'none';
                colorsSlotInner.style.transition = 'none';
                
                clothesSlotInner.style.top = (-randomClothesIndex * 150) + 'px';
                colorsSlotInner.style.top = (-randomColorsIndex * 150) + 'px';
                
                currentClothesIndex = randomClothesIndex;
                currentColorsIndex = randomColorsIndex;
                
                generateOptions();
            }
        }

        function generateOptions() {
            optionsContainer.innerHTML = "";
            
            const currentClothes = clothes[currentClothesIndex];
            const currentColor = colors[currentColorsIndex];
            
            // Determinar a forma correta da cor baseada no gênero e número da roupa
            let correctColorForm = "";
            if (currentColor.name === "beige" || currentColor.name === "marron" || currentColor.name === "orange") {
                // Cores invariáveis
                correctColorForm = currentColor.variations[0];
                if (currentClothes.number === "p") {
                    correctColorForm = currentColor.variations[1] || currentColor.variations[0];
                }
            } else {
                // Cores que variam em gênero e número
                const variationIndex = (currentClothes.gender === "m" ? 0 : 1) + (currentClothes.number === "s" ? 0 : 2);
                correctColorForm = currentColor.variations[variationIndex];
            }
            
            // Criar opções para artigo
            const articleOptions = [currentClothes.article];
            
            // Adicionar artigos incorretos para dificultar
            if (currentClothes.article === "un") {
                articleOptions.push("une", "des");
            } else if (currentClothes.article === "une") {
                articleOptions.push("un", "des");
            } else {
                articleOptions.push("un", "une");
            }
            
            // Embaralhar opções
            shuffleArray(articleOptions);
            
            // Adicionar opções de artigo ao container
            articleOptions.forEach(article => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = article;
                optionElement.dataset.type = 'article';
                optionElement.addEventListener('click', function() {
                    selectOption(this, 'article', article);
                });
                optionsContainer.appendChild(optionElement);
            });
            
            // Criar opções para roupa
            const clothesOptions = [currentClothes.name];
            
            // Adicionar outras roupas para dificultar
            const otherClothes = clothes.filter(item => item.name !== currentClothes.name);
            shuffleArray(otherClothes);
            clothesOptions.push(otherClothes[0].name, otherClothes[1].name);
            
            // Embaralhar opções
            shuffleArray(clothesOptions);
            
            // Adicionar opções de roupa ao container
            clothesOptions.forEach(cloth => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = cloth;
                optionElement.dataset.type = 'clothes';
                optionElement.addEventListener('click', function() {
                    selectOption(this, 'clothes', cloth);
                });
                optionsContainer.appendChild(optionElement);
            });
            
            // Criar opções para cor
            const colorOptions = [correctColorForm];
            
            // Adicionar outras formas da mesma cor ou cores diferentes
            const otherColors = [...currentColor.variations.filter(v => v !== correctColorForm)];
            
            // Se não houver variações suficientes, adicionar cores de outras cores
            if (otherColors.length < 2) {
                const otherColorNames = colors.filter(color => color.name !== currentColor.name);
                shuffleArray(otherColorNames);
                
                // Adicionar uma forma apropriada da outra cor
                const otherColor = otherColorNames[0];
                let otherColorForm = "";
                if (otherColor.name === "beige" || otherColor.name === "marron" || otherColor.name === "orange") {
                    otherColorForm = otherColor.variations[0];
                } else {
                    const variationIndex = (currentClothes.gender === "m" ? 0 : 1) + (currentClothes.number === "s" ? 0 : 2);
                    otherColorForm = otherColor.variations[variationIndex];
                }
                colorOptions.push(otherColorForm);
                
                // Adicionar outra cor se necessário
                if (otherColors.length === 0) {
                    const anotherColor = otherColorNames[1];
                    let anotherColorForm = "";
                    if (anotherColor.name === "beige" || anotherColor.name === "marron" || anotherColor.name === "orange") {
                        anotherColorForm = anotherColor.variations[0];
                    } else {
                        const variationIndex = (currentClothes.gender === "m" ? 0 : 1) + (currentClothes.number === "s" ? 0 : 2);
                        anotherColorForm = anotherColor.variations[variationIndex];
                    }
                    colorOptions.push(anotherColorForm);
                } else {
                    colorOptions.push(otherColors[0]);
                }
            } else {
                colorOptions.push(otherColors[0], otherColors[1]);
            }
            
            // Embaralhar opções
            shuffleArray(colorOptions);
            
            // Adicionar opções de cor ao container
            colorOptions.forEach(color => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = color;
                optionElement.dataset.type = 'color';
                optionElement.addEventListener('click', function() {
                    selectOption(this, 'color', color);
                });
                optionsContainer.appendChild(optionElement);
            });
        }

        function selectOption(element, type, value) {
            playSound(buttonSound);
            
            // Remover seleção anterior do mesmo tipo
            const previousSelected = optionsContainer.querySelector(`.option.selected[data-type="${type}"]`);
            if (previousSelected) {
                previousSelected.classList.remove('selected');
                
                // Limpar slot correspondente
                if (type === 'article') {
                    articleSlot.textContent = "";
                    selectedArticle = "";
                } else if (type === 'clothes') {
                    clothesSlotWord.textContent = "";
                    selectedClothes = "";
                } else if (type === 'color') {
                    colorsSlotWord.textContent = "";
                    selectedColor = "";
                }
            }
            
            // Adicionar seleção atual
            element.classList.add('selected');
            
            // Atualizar slot correspondente
            if (type === 'article') {
                articleSlot.textContent = value;
                selectedArticle = value;
            } else if (type === 'clothes') {
                clothesSlotWord.textContent = value;
                selectedClothes = value;
            } else if (type === 'color') {
                colorsSlotWord.textContent = value;
                selectedColor = value;
            }
        }

        function checkAnswer() {
            const currentClothes = clothes[currentClothesIndex];
            const currentColor = colors[currentColorsIndex];
            
            // Determinar a forma correta da cor
            let correctColorForm = "";
            if (currentColor.name === "beige" || currentColor.name === "marron" || currentColor.name === "orange") {
                // Cores invariáveis
                correctColorForm = currentColor.variations[0];
                if (currentClothes.number === "p") {
                    correctColorForm = currentColor.variations[1] || currentColor.variations[0];
                }
            } else {
                // Cores que variam em gênero e número
                const variationIndex = (currentClothes.gender === "m" ? 0 : 1) + (currentClothes.number === "s" ? 0 : 2);
                correctColorForm = currentColor.variations[variationIndex];
            }
            
            // Verificar resposta
            const isArticleCorrect = selectedArticle === currentClothes.article;
            const isClothesCorrect = selectedClothes === currentClothes.name;
            const isColorCorrect = selectedColor === correctColorForm;
            const isCorrect = isArticleCorrect && isClothesCorrect && isColorCorrect;
            
            // Exibir feedback
            if (isCorrect) {
                feedback.textContent = "CORRETO";
                feedback.className = "feedback correct";
                playSound(winSound);
                correctAnswers++;
            } else {
                feedback.textContent = "INCORRETO";
                feedback.className = "feedback incorrect";
                playSound(errorSound);
                
                // Mostrar resposta correta
                const correctAnswerText = `${currentClothes.article} ${currentClothes.name} ${correctColorForm}`;
                correctAnswer.textContent = `Resposta correta: ${correctAnswerText}`;
                
                // Mostrar tradução
                const colorTranslation = translations[currentColor.name] || currentColor.name;
                const clothesTranslation = translations[currentClothes.name] || currentClothes.name;
                translation.textContent = `Tradução: ${translations[currentClothes.article] || ""} ${clothesTranslation} ${colorTranslation}`;
            }
            
            // Salvar progresso
            saveProgress();
        }

        function updateProgressBar() {
            const progress = ((currentQuestion + 1) / totalQuestions) * 100;
            progressBar.style.width = progress + '%';
        }

        function showResults() {
            gamePage.style.display = 'none';
            resultsPage.style.display = 'flex';
            
            const percentage = (correctAnswers / totalQuestions) * 100;
            
            if (percentage >= 95) {
                resultsTitle.textContent = "EXCELENTE";
                resultsText.textContent = `Parabéns pelo seu desempenho excepcional! Você alcançou um resultado EXCELENTE, acertando ${correctAnswers} das ${totalQuestions} palavras no quiz de escrita em francês! Isso demonstra um domínio impressionante das expressões e da ortografia francesa. Continue assim, pois seu esforço e dedicação são inspiradores! Este resultado reflete não apenas sua habilidade linguística, mas também sua atenção aos detalhes e compromisso em aprender. Que tal continuar explorando o idioma com o mesmo entusiasmo? A prática constante vai te levar ainda mais longe.`;
                resultsMascot.src = "MASCOTEFELIZ.png";
                playSound(positiveSound);
            } else if (percentage >= 75) {
                resultsTitle.textContent = "PARABÉNS";
                resultsText.textContent = `Parabéns pelo seu desempenho! Você obteve um BOM resultado, acertando ${correctAnswers} das ${totalQuestions} palavras no quiz de escrita em francês! Isso mostra que você está no caminho certo, com uma sólida compreensão do idioma. Sua dedicação está valendo a pena, e cada palavra certa é um passo rumo à fluência. Continue assim, brilhando no aprendizado do francês!`;
                resultsMascot.src = "MASCOTEALEGRE.png";
                playSound(positiveSound);
            } else if (percentage >= 60) {
                resultsTitle.textContent = "QUASE LÁ";
                resultsText.textContent = `Você alcançou o nível SUFICIENTE, acertando ${correctAnswers} das ${totalQuestions} palavras no quiz de escrita em francês! Isso indica um progresso notável, com uma boa base no idioma. Sua dedicação está clara, e você está muito próximo de resultados ainda melhores. Cada palavra escrita é um avanço no aprendizado do francês. Continue se empenhando, e logo verá seu desempenho crescer! Siga firme na jornada para dominar o idioma!`;
                resultsMascot.src = "MASCOTEDUVIDA.png";
                playSound(negativeSound);
            } else {
                resultsTitle.textContent = "NÃO FOI DESSA VEZ";
                resultsText.textContent = `Você obteve o nível INSUFICIENTE, acertando ${correctAnswers} das ${totalQuestions} palavras no quiz de escrita em francês. Não desanime! Cada tentativa é uma oportunidade de aprendizado, e você já deu o primeiro passo ao participar. O francês pode ser desafiador, mas com prática, você vai melhorar. Reforce as palavras e continue se dedicando. Sua persistência vai te levar mais longe na jornada do idioma!`;
                resultsMascot.src = "MASCOTEDUVIDA.png";
                playSound(negativeSound);
            }
        }

        function saveProgress() {
            const progress = {
                currentQuestion: currentQuestion,
                correctAnswers: correctAnswers,
                totalQuestions: totalQuestions,
                usedClothesIndices: usedClothesIndices
            };
            localStorage.setItem('quizProgress', JSON.stringify(progress));
        }

        function loadProgress() {
            const savedProgress = localStorage.getItem('quizProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentQuestion = progress.currentQuestion || 0;
                correctAnswers = progress.correctAnswers || 0;
                totalQuestions = progress.totalQuestions || 20;
                usedClothesIndices = progress.usedClothesIndices || [];
                updateProgressBar();
            }
        }

        function playSound(soundElement) {
            soundElement.currentTime = 0;
            soundElement.play();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Carregar progresso salvo
        loadProgress();
    </script>
</body>
</html>
